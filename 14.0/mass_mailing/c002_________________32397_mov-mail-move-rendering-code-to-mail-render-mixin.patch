PR: https://github.com/odoo/odoo/pull/32397

From: 822f468059c9702b0898016e7bfbaf036a2c4036
From: Thibault Delavall√©e
Date: 2020-03-24 10:24:19

Structural Changes: 2
Total Changes: 48

[MOV] mail: move rendering code to mail render mixin

We also have to update code calling directly the rendering itself. Indeed
some code bits does some rendering directly on jinja-enabled input and not
through templates. Those calls have to be updated accordingly.

LINKS

Task ID 1963529
Community PR odoo/odoo#32397

================================= pseudo patch: =================================

--- a/addons/mass_mailing/models/__init__.py
+++ b/addons/mass_mailing/models/__init__.py
@@ -7,7 +7,7 @@ from . import mailing_list
 from . import mailing_trace
 from . import mailing
 from . import mail_mail
-from . import mail_template
+from . import mail_render_mixin
 from . import mail_thread
 from . import res_config_settings
 from . import res_users

--- a/addons/mass_mailing/models/mail_template.py
+++ b/addons/mass_mailing/models/mail_render_mixin.py
@@ -4,13 +4,13 @@
 from odoo import api, models
 
 
-class MailTemplate(models.Model):
-    _inherit = "mail.template"
+class MailRenderMixin(models.AbstractModel):
+    _inherit = "mail.render.mixin"
 
     @api.model
     def _render_template_postprocess(self, rendered):
         # super will transform relative url to absolute
-        rendered = super(MailTemplate, self)._render_template_postprocess(rendered)
+        rendered = super(MailRenderMixin, self)._render_template_postprocess(rendered)
 
         # apply shortener after
         if self.env.context.get('post_convert_links'):
