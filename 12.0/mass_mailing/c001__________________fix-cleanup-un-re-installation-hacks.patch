PR: https://github.com/odoo/odoo/pull/

From: 503b8ed6925eddc36afd05683eaaad1a93312c8d
From: Adrian Torres
Date: 2018-06-11 07:47:34

Structural Changes: 1
Total Changes: 31

[FIX] *: cleanup (un|re)installation hacks

Replace hacks introduced in V11 by the proper solution.

================================= pseudo patch: =================================

--- a/addons/mass_mailing/models/__init__.py
+++ b/addons/mass_mailing/models/__init__.py
@@ -8,5 +8,4 @@ from . import mail_thread
 from . import res_config_settings
 from . import mass_mailing_report
 from . import link_tracker
-from . import ir_model_fields
 from . import res_users

--- a/addons/mass_mailing/models/ir_model_fields.py
+++ b/None
@@ -1,30 +0,0 @@
-# -*- coding: utf-8 -*-
-# Part of Odoo. See LICENSE file for full copyright and licensing details
-
-from odoo import api, models
-
-
-# This is a nasty hack, targeted for V11 only
-class IrModelFields(models.Model):
-    _inherit = 'ir.model.fields'
-
-    @api.multi
-    def unlink(self):
-        # Prevent the deletion of social_* fields defined in res.company if
-        # the other module is installed
-        social = (
-            'social_facebook',
-            'social_github',
-            'social_googleplus',
-            'social_linkedin',
-            'social_twitter',
-            'social_youtube',
-        )
-
-        self = self.filtered(
-            lambda rec: not (
-                rec.model == 'res.company' and
-                rec.name in social
-            )
-        )
-        return super(IrModelFields, self).unlink()
