PR: https://github.com/odoo/odoo/pull/29308

From: 66f0e26f6f3f2155fcfcc55e84f2e76cbfdb2c1d
From: Xavier Morel
Date: 2018-12-07 13:37:34

Structural Changes: 4
Total Changes: 9

[CHG] *: make binary fields default to attachment=True

Check that it makes custom binary fields into attachment as that's the
main reason for the change: when users create binary fields via Studio,
they're necessarily db-stored (as the interface doesn't allow altering
the attachment attribute and it's unclear how we'd handle users
switching it on/off every time), which significantly bloats their
database (and burns storage & backup space), especially as the primary
use case for binary fields is adding images and documents to records.

* check that binary fields are properly created as attachment=True
* add attachment=False on fields where that seems relevant (most but not
  all of the fields previously using the default)
* remove occurrences of attachment=True

closes odoo/odoo#29308

================================= pseudo patch: =================================

--- a/addons/product/models/product.py
+++ b/addons/product/models/product.py
@@ -114,7 +114,7 @@ class ProductProduct(models.Model):
         'product.template.attribute.value', string='Template Attribute Values', compute="_compute_product_template_attribute_value_ids")
     # image: all image fields are base64 encoded and PIL-supported
     image_variant = fields.Binary(
-        "Variant Image", attachment=True,
+        "Variant Image",
         help="This field holds the image used as image for the product variant, limited to 1024x1024px.")
     image = fields.Binary(
         "Big-sized image", compute='_compute_images', inverse='_set_image',

--- a/addons/product/models/product_template.py
+++ b/addons/product/models/product_template.py
@@ -135,15 +135,14 @@ class ProductTemplate(models.Model):
 
     # image: all image fields are base64 encoded and PIL-supported
     image = fields.Binary(
-        "Image", attachment=True,
-        help="This field holds the image used as image for the product, limited to 1024x1024px.")
+        "Image", help="This field holds the image used as image for the product, limited to 1024x1024px.")
     image_medium = fields.Binary(
-        "Medium-sized image", attachment=True,
+        "Medium-sized image",
         help="Medium-sized image of the product. It is automatically "
              "resized as a 128x128px image, with aspect ratio preserved, "
              "only when the image exceeds one of those sizes. Use this field in form views or some kanban views.")
     image_small = fields.Binary(
-        "Small-sized image", attachment=True,
+        "Small-sized image",
         help="Small-sized image of the product. It is automatically "
              "resized as a 64x64px image, with aspect ratio preserved. "
              "Use this field anywhere a small image is required.")
