PR: https://github.com/odoo/odoo/pull/83397

From: ed02c3285318ce92c452cd407b1ce59e4ad54ff7
From: RÃ©my Baranx (bar)
Date: 2022-06-14 08:35:54

Structural Changes: 4
Total Changes: 8

[FIX] google_calendar: allow user to reset his own tokens only

Each user should be able to reset his own google calendar token.
An admin user (from `base.group_system`) should be able to reset any tokens.

Task-2673934

closes odoo/odoo#83397

Signed-off-by: Arnaud Joset <arj@odoo.com>

================================= pseudo patch: =================================

--- a/addons/google_calendar/models/google_credentials.py
+++ b/addons/google_calendar/models/google_credentials.py
@@ -20,10 +20,10 @@ class GoogleCredentials(models.Model):
     _description = 'Google Calendar Account Data'
 
     user_ids = fields.One2many('res.users', 'google_cal_account_id', required=True)
-    calendar_rtoken = fields.Char('Refresh Token', copy=False, groups="base.group_system")
-    calendar_token = fields.Char('User token', copy=False, groups="base.group_system")
-    calendar_token_validity = fields.Datetime('Token Validity', copy=False, groups="base.group_system")
-    calendar_sync_token = fields.Char('Next Sync Token', copy=False, groups="base.group_system")
+    calendar_rtoken = fields.Char('Refresh Token', copy=False)
+    calendar_token = fields.Char('User token', copy=False)
+    calendar_token_validity = fields.Datetime('Token Validity', copy=False)
+    calendar_sync_token = fields.Char('Next Sync Token', copy=False)
     calendar_cal_id = fields.Char('Calendar ID', copy=False, help='Last Calendar ID who has been synchronized. If it is changed, we remove all links between GoogleID and Odoo Google Internal ID')
     synchronization_stopped = fields.Boolean('Google Synchronization stopped', copy=False)
 
